!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e,n){"use strict";const r=n(16),i=n(29),o={error:1,warning:2,info:3,debug:4},s=(t,e,n,o)=>{return r.gray.dim("<")+r.yellow((new Date).toISOString())+r.gray(">")+" "+r.cyan(e)+r.white(".")+r.magenta(n)+" "+r.gray("[")+r.blue(t)+r.gray("]")+r.green(" ")+i.inspect(o,{depth:5,colors:!0,sorted:!0})};t.exports=class{constructor(t,e,n,r,i,o){this.contextId=t,this.contextName=n,this.contextType=e,this.logLevel=r,this.outputPipe=i,this.errorPipe=o}warn(t){this.logLevel>=o.warn&&this.outputPipe.write(s(this.contextId,this.contextType,this.contextName,t)+"\n")}info(t){this.logLevel>=o.info&&this.outputPipe.write(s(this.contextId,this.contextType,this.contextName,t)+"\n")}debug(t){this.logLevel>=o.debug&&this.outputPipe.write(s(this.contextId,this.contextType,this.contextName,t)+"\n")}error(t){this.logLevel>=o.error&&this.errorPipe.write(s(this.contextId,this.contextType,this.contextName,t)+"\n")}}},function(t,e,n){"use strict";const{parse:r,stringify:i}=n(15);t.exports=class{asFlattened(){return i(this)}loadFlattened(t){return this.fromJSON(r(t)),this}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(6)),i=o(n(7));function o(t){return t&&t.__esModule?t:{default:t}}const s=n(4),a=n(1),u=n(0);e.default=class extends a{constructor(t,e,n,r,i,o,s){super(),this.application=t,void 0!==n&&this.fromJSON({id:e||this.application.getUniqueId(),name:n||"Unnamed",to:r||void 0,accepts:i||[],retry:o||void 0,actions:s||[]})}toJSON(){return{id:this.id,name:this.name,to:this.to,accepts:this.accepts,retry:this.retry,actions:this.actions}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Channel JSON to be a string or an object, but got a ${typeof t} instead`);e=t}if(this.id=e.id,this.name=e.name,e.to instanceof r.default)this.connect(e.to);else if(void 0!==e.to){let t;void 0!==this.application.publicFlow&&(t=(new i.default).search(this.application,e.to.id)),t?this.connect(t):this.connect(new r.default(this.application).fromJSON(e.to))}this.retry=e.retry,this.accepts=[],this.actions=[];for(var n=0,o=e.accepts.length;n<o;n++)this.accepts.push(e.accepts[n]);for(n=0,o=e.actions.length;n<o;n++)e.actions[n]instanceof s?this.actions.push(e.actions[n]):this.actions.push(new s(this.application).fromJSON(e.actions[n]));return this.log=new u(this.id,"Channel",this.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),this}addAction(t){if(t instanceof s)this.actions.push(t);else{const e=this.application.getAction(t);if(!e)throw RangeError(`Could not find the ${e} action`);this.actions.push(e)}}connect(t){this.to=t}async process(t,e){this.log.debug("Processing channel"),this.application.emit("Channel",this,t.request);for(const n of this.actions)this.log.debug(`Executing channel action ${n.name}`),this.application.emit("Action",n,t.request),await n.execute(e)}}},function(t,e,n){var r={};t.exports=r,r.themes={};var i=r.styles=n(17),o=Object.defineProperties;r.supportsColor=n(18).supportsColor,void 0===r.enabled&&(r.enabled=!1!==r.supportsColor()),r.stripColors=r.strip=function(t){return(""+t).replace(/\x1B\[\d+m/g,"")};r.stylize=function(t,e){return r.enabled?i[e].open+t+i[e].close:t+""};var s=/[|\\{}()[\]^$+*?.]/g;function a(t){var e=function t(){return function(){var t=arguments,e=t.length,n=0!==e&&String(arguments[0]);if(e>1)for(var o=1;o<e;o++)n+=" "+t[o];if(!r.enabled||!n)return n;var s=this._styles,a=s.length;for(;a--;){var u=i[s[a]];n=u.open+n.replace(u.closeRe,u.open)+u.close}return n}.apply(t,arguments)};return e._styles=t,e.__proto__=f,e}var u,c=(u={},i.grey=i.gray,Object.keys(i).forEach(function(t){i[t].closeRe=new RegExp(function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(s,"\\$&")}(i[t].close),"g"),u[t]={get:function(){return a(this._styles.concat(t))}}}),u),f=o(function(){},c);r.setTheme=function(t){if("string"!=typeof t)for(var e in t)!function(e){r[e]=function(n){if("object"==typeof t[e]){var i=n;for(var o in t[e])i=r[t[e][o]](i);return i}return r[t[e]](n)}}(e);else console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));")};var l=function(t,e){var n=e.split("");return(n=n.map(t)).join("")};for(var h in r.trap=n(21),r.zalgo=n(22),r.maps={},r.maps.america=n(23),r.maps.zebra=n(24),r.maps.rainbow=n(25),r.maps.random=n(26),r.maps)!function(t){r[t]=function(e){return l(r.maps[t],e)}}(h);o(r,function(){var t={};return Object.keys(c).forEach(function(e){t[e]={get:function(){return a([e])}}}),t}())},function(t,e,n){"use strict";const r=n(1),i=n(0);t.exports=class extends r{constructor(t,e,n,r){super(),this.application=t,void 0!==n&&this.fromJSON({id:e||this.application.getUniqueId(),name:n||"Unnamed",method:r||"() => {}"})}toJSON(){return{id:this.id,name:this.name,method:this.method.toString()}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Action JSON to be a string or an object, but got a ${typeof t} instead`);e=t}return this.id=e.id,this.name=e.name,"string"==typeof e.method?this.method=new Function(`return ${e.method}`)():this.method=e.method,this.log=new i(this.id,"Action",this.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),this}async execute(t){await this.method.call(t)}}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!f){var t=a(h);f=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||f||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(2))&&r.__esModule?r:{default:r};const o=n(4),s=n(1),a=n(0);e.default=class extends s{constructor(t,e,n,r,i,o){super(),this.application=t,void 0!==n&&this.fromJSON({id:e||this.application.getUniqueId(),name:n||"Unnamed",to:r||[],tags:i||[],actions:o||[]})}toJSON(){return{id:this.id,name:this.name,to:this.to,tags:this.tags,actions:this.actions}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Node JSON to be a string or an object, but got a ${typeof t} instead`);e=t}this.id=e.id,this.name=e.name,this.to=[];for(var n=0,r=e.to.length;n<r;n++)e.to[n]instanceof i.default?this.connect(e.to[n]):this.connect(new i.default(this.application).fromJSON(e.to[n]));for(this.tags=e.tags,this.actions=[],n=0,r=e.actions.length;n<r;n++)e.actions[n]instanceof o?this.actions.push(e.actions[n]):this.actions.push(new o(this.application).fromJSON(e.actions[n]));return this.log=new a(this.id,"Node",this.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),this}addAction(t){if(t instanceof o)this.actions.push(t);else{const e=this.application.getAction(t);if(!e)throw RangeError(`Could not find the ${e} action`);this.actions.push(e)}}connect(t){this.to.push(t)}async process(t,e){this.log.debug(`Processing node ${this.name}`),this.application.emit("Node",this,t.request);for(const n of this.actions)this.log.debug(`Executing node action ${n.name}`),this.application.emit("Action",n,t.request),await n.execute(e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(13)),i=a(n(2)),o=a(n(10)),s=a(n(8));function a(t){return t&&t.__esModule?t:{default:t}}e.default=class{search(t,e){let n;if(t instanceof r.default){if(!t.publicFlow)throw Error("Spider requires Application to have a Public Flow defined");n=[t.publicFlow.to]}else n=t instanceof i.default||t instanceof o.default||t instanceof s.default?[t.to]:void 0!==t.id?t.to:t;for(var a=0,u=n.length;a<u;a++){var c=!1;if((!e.id&&!e.name||n[a]!==e&&n[a].id!==e.id&&n[a].name!==e.name)&&n[a].id!==e&&n[a].name!==e||(c=!0),c)return n[a];if(n[a].to)return this.search(n[a].to,e)}return!1}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(6)),i=o(n(7));function o(t){return t&&t.__esModule?t:{default:t}}const s=n(1),a=n(9),u=n(0),c=()=>{};e.default=class extends s{constructor(t,e,n,r,i,o,s,a){super(),this.application=t,void 0!==n&&this.fromJSON({id:e||this.application.getUniqueId(),name:n||"Unnamed",config:Object.assign({},r||{}),to:i,endpointMethod:o||"GET",endpointRoute:s||"/"+n||"Unnamed",endpointParams:a||[]})}toJSON(){return{id:this.id,name:this.name,config:this.config,to:this.to,endpointMethod:this.endpointMethod,endpointRoute:this.endpointRoute,endpointParams:this.endpointParams}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Flow JSON to be a string or an object, but got a ${typeof t} instead`);e=t}if(this.id=e.id,this.name=e.name,this.config=e.config,e.to instanceof r.default)this.connect(e.to);else if(void 0!==e.to){let t;void 0!==this.application.publicFlow&&(t=(new i.default).search(this.application,e.to.id)),t?this.connect(t):this.connect(new r.default(this.application).fromJSON(e.to))}if(e.to instanceof r.default)this.connect(e.to);else if(void 0!==e.to){let t;void 0!==this.application.publicFlow&&(t=(new i.default).search(this.application,e.to.id)),t?this.connect(t):this.connect(new r.default(this.application).fromJSON(e.to))}return this.endpointRoute=e.endpointRoute,this.endpointMethod=e.endpointMethod,this.endpointParams=e.endpointParams,this.onError=c,this.onComplete=c,this.log=new u(this.id,"Flow",this.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),this}connect(t){this.to=t}registerRequest(t,e){const n=new a(this.application,void 0,e,this,t);return this.application.activeRequests.set(n.id,n),n}request(t,e){return this.application.emit("Flow.start",this,e),new Promise((t,n)=>{this.log.debug(`Waiting for Request ${e.id} to complete...`);const r=this.application.on("Flow.end",(i,o,s)=>{if(this.log.debug("Handling flow end..."),void 0!==s)return n(s);o===e&&(this.application.off(r),this.log.debug(`Request ${e.id} complete.`),t(o.getState()))});this.log.debug("Dispatching flow..."),this.application.dispatch("Flow.start",e,this,this)})}async process(t,e){this.log.debug("Processing flow",this.name),this.application.emit("Flow.start",this,t.request),void 0!==this.to&&(this.log.debug("Dispatching event to proceed to node from flow..."),this.application.dispatch(`Node.${this.to.name}`,t.request,this,this.to))}}},function(t,e,n){"use strict";const r=n(32),i=()=>{},o=new WeakMap,s=n(0);t.exports=class{constructor(t,e={},n,r,a){const u=Object.entries(e);this.application=t,this.changes=[],this.id=this.application.getUniqueId();for(const[e,i]of u)this.changes.push({appId:t.id,flowId:n.id,stepId:r.id,key:e,value:i});this.onCyclicWarning=i,this.onCyclicError=i,this.accumulatedActions=[],this.steps=[],this.stack=o.set(this,new Map),this.log=new s(this.id,"Request",this.application.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe)}toJSON(){return{id:this.id,changes:this.changes,accumulatedActions:this.accumulatedActions,steps:this.steps,state:this.getState()}}change(t,e,n,r,i){return this.changes.push({appId:t.id,flowId:e.id,stepId:n.id,key:r,value:i}),this.application.emit("ValueChange",{[r]:i},this),this}thenChange(t,e,n){const r=this.changes[this.changes.length-1];return this.changes.push({appId:r.appId,flowId:r.flowId,stepId:n||r.stepId,key:t,value:e}),this.application.emit("ValueChange",{[t]:e},this),this}getState(t){const e={},n=Object.entries(t||{});for(var[r,i]of n)e[r]=i;for(var o=0,s=this.changes.length;o<s;o++)e[this.changes[o].key]=this.changes[o].value;return e}addStep(t,e,n){const i=o.get(this),s=i.get(n.id)||1;if(s>100)throw new r;i.set(n.id,s+1),this.steps.push({appId:t.id,flowId:e.id,stepId:n.id})}addAction(t){return this.accumulatedActions.push(t),this}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(2))&&r.__esModule?r:{default:r};const o=n(4),s=n(1),a=n(0);e.default=class extends s{constructor(t,e,n,r,i,o,s){super(),this.application=t,this.flow=e,void 0!==r&&this.fromJSON({id:n||this.application.getUniqueId(),name:r||"Unnamed",strategy:i||"fcfs",to:o||[],actions:s||[]})}toJSON(){return{id:this.id,name:this.name,strategy:this.strategy,to:this.to,actions:this.actions}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Milestone JSON to be a string or an object, but got a ${typeof t} instead`);e=t}this.id=e.id,this.name=e.name,this.strategy=e.strategy,this.to=[];for(var n=0,r=e.to.length;n<r;n++)e.to[n]instanceof i.default?this.connect(e.to[n]):this.connect(new i.default(this.application).fromJSON(e.to[n]));for(this.actions=[],n=0,r=e.actions.length;n<r;n++)e.actions[n]instanceof o?this.addAction(e.actions[n]):this.addAction(new o(this.application).fromJSON(e.actions[n]));return this.requestIdHistory=[],this.log=new a(this.id,"Milestone",this.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),this}connect(t){this.to.push(t)}addAction(t){if(t instanceof o)this.actions.push(t);else{const e=this.application.getAction(t);if(!e)throw RangeError(`Could not find the ${e} action`);this.actions.push(e)}}async process(t,e){this.log.debug("Processing Milestone"),this.application.emit("Milestone.start",this,t.request);for(const n of this.actions)this.log.debug(`Executing Milestone action ${n.name}`),this.application.emit("Action",n,t.request),await n.execute(e);for(const n of t.request.accumulatedActions)this.log.debug(`Executing Accumulated action ${action.name}`),this.application.emit("Action",n,t.request),await n.execute(e);this.application.emit("Milestone.end",this,t.request),void 0===this.to&&this.application.emit("Flow.end",this.flow,t.request)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=u(n(6)),i=u(n(2)),o=u(n(7)),s=u(n(10)),a=u(n(8));function u(t){return t&&t.__esModule?t:{default:t}}const c=n(9),f=n(1);n(0);e.default=class extends f{constructor(t,e,n,r,i,o,s,a){super(),this.application=t,void 0!==n&&this.fromJSON({id:e||this.application.getUniqueId(),request:r||void 0,from:i||void 0,flow:o||void 0,type:n||"event",retries:s||0,error:a||void 0})}attachRequest(t){this.request=t}setError(t){this.error=t.toString()}toJSON(){return{id:this.id,request:this.request,from:this.from.id,type:this.type,flow:this.flow.id,retries:this.retries}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Event JSON to be a string or an object, but got a ${typeof t} instead`);e=t}if(this.id=e.id,this.type=e.type,this.error=e.error,e.request instanceof c?this.request=e.request:void 0!==e.request&&(this.request=(new c).fromJSON(e.request)),e.from instanceof r.default||e.from instanceof s.default||e.from instanceof i.default||e.from instanceof a.default)this.from=e.from;else if(void 0!==e.from){const t=(new o.default).search(this.application,e.from);this.from=t}if(e.flow instanceof a.default)this.flow=e.from;else if(void 0!==e.from){const t=(new o.default).search(this.application,e.flow);this.flow=t}return this.retries=e.retries,this}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(8)),i=o(n(11));function o(t){return t&&t.__esModule?t:{default:t}}const s=n(33),a=n(36),u=n(46),c=n(4),f=n(9),l=n(1),h=n(0),p=()=>{};e.default=class extends l{constructor(e,n,r,i,o,s,u,c,f){super(),this.inputPipe=u||t.stdout,this.outputPipe=c||t.stdout,this.errorPipe=f||t.strerr,this.fromJSON({id:e||a()(),name:n||"Unnamed",config:Object.assign({logLevel:3},r||{}),publicFlow:i||void 0,flows:o||[],actions:s||new Map})}async httpRequestHandler(t,e){const n=t.url.split("?"),r=await this.request(t.method,n[0],n[1]);e.writeHead(200,{"Content-Type":"text/plain"}),e.end(JSON.stringify(r))}listen(){this.inputPipe.setEncoding("utf8"),this.inputPipe.on("readable",()=>{this.onInput(this.inputPipe.read())}),this.inputPipe.on("end",this.onShutdown)}unlisten(){this.inputPipe.removeAllListeners()}setOnEvent(t){this.onEvent=t||p}setOnInput(t){this.onInput=t||p}setOnShutdown(t){this.onShutdown=t||p}getConfig(t){return this.config[t]}setConfig(t,e){return this.config[t]=e,this.config[t]}toJSON(){const t=[];for(var[e,n]of this.actions.entries())t.push([e,n]);return{id:this.id,name:this.name,config:this.config,publicFlow:this.publicFlow,flows:this.flows,actions:t,eventQueue:this.eventQueue}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Application JSON to be a string or an object, but got a ${typeof json} instead`);e=t}0===e.flows.length&&e.publicFlow&&e.flows.push(e.publicFlow),this.id=e.id,this.name=e.name,this.config=e.config,this.flows=[],this.actions=new Map,this.activeRequests=new Map,this.eventQueue=new u(this,e.eventQueue||[]),this.listeners=[],this.onEvent=p,this.onInput=p,this.onShutdown=p,e.publicFlow instanceof r.default?(this.publicFlow=e.publicFlow,e.publicFlow.application=this):e.publicFlow instanceof Object&&(this.publicFlow=new r.default(this).fromJSON(e.publicFlow));for(var n=0,i=e.flows.length;n<i;n++)e.flows[n]instanceof r.default?(e.flows[n].application=this,this.registerFlow(e.flows[n])):e.flows[n]instanceof Object&&this.registerFlow(new r.default(this).fromJSON(e.flows[n]));for(n=0,i=e.actions.length;n<i;n++)e.actions[n]instanceof c?(e.actions[n].application=this,this.registerAction(e.actions[n].name,e.actions[n])):e.actions[n]instanceof Object&&this.registerAction(e.actions[n][0],new c(this).fromJSON(e.actions[n][1]));return this.log=new h(this.id,"Application",this.name,this.config.logLevel,this.outputPipe,this.errorPipe),this}setPublicFlow(t){this.publicFlow=t,-1===this.flows.indexOf(t)&&this.registerFlow(t)}dispatch(t,e,n,r,o=0,s){if(this.log.debug(`Dispatch starts from ${r.name} with type ${t}`),r.to)if(r.to instanceof Array){let a=!1;for(const s in r.to)if(r.to[s].accepts.indexOf(t)>-1){this.log.debug(`... and leads to ${r.to[s].name}`),this.log.debug(`Dispatching ${t} to ${r.to[s].name}`);const u=new i.default(this,void 0,t,e,r.to[s],n,o);this.eventQueue.push(u),a=!0}a||(s&&this.emit("Flow.end",n,e,s),this.emit("Flow.end",n,e))}else if(s)this.emit("Flow.end",n,e,s);else{this.log.debug("... and leads to",r.to.name);const s=new i.default(this,void 0,t,e,r.to,n,o);this.eventQueue.push(s)}else if(s)this.emit("Flow.end",n,e,s);else{this.log.debug(`... and leads to ${r.to.name}`);const s=new i.default(this,void 0,t,e,r.to,n,o);this.eventQueue.push(s)}}processEvents(){this.eventQueue.process()}registerAction(t,e){return this.actions.set(t,e),e}getAction(t){return this.actions.get(t)}requireAction(t,e){let n=this.getAction(t);return n||(n=this.registerAction(t,new c(this,void 0,t,e))),n}getFlow(t){for(var e=0,n=this.flows.length;e<n;e++)if(this.flows[e].id===t||this.flows[e].name===t)return this.flows[e];return!1}getFlowByHttp(t,e){for(var n=0,r=this.flows.length;n<r;n++)if(this.flows[n].endpointMethod===t&&this.flows[n].endpointRoute===e)return this.flows[n];return!1}getUniqueId(){return a()()}registerFlow(t){for(const e in this.flows)if(this.flows[e].id===t.id||this.flows[e].endpointRoute===t.endpointRoute&&this.flows[e].endpointMethod===t.endpointMethod)return void(this.flows[t]=t);this.flows.push(t)}connect(t){this.publicFlow.connect(t)}async emit(t,e,n,r){for(const i of this.listeners)i.eventType===t&&await i.method(e,n,r);const i=void 0!==e.id&&void 0!==e.name?{id:e.id,name:e.name}:e,o=n.getState?n.getState():n;this.onEvent(t,i,o,r)}on(t,e){const n={eventType:t,method:e};return this.listeners.push(n),n}off(t){const e=this.listeners.indexOf(t);e>-1&&this.listeners.splice(e,1)}async request(t,e,n){this.log.debug("Starting Request...");const r=this.getFlowByHttp(t,e);if("string"==typeof n)n=s.parse(n);else if(!(n instanceof Object))throw new TypeError(`Unknown flow request of type ${typeof n}`);this.emit("Request.start",this,n);const i=new f(this,n,r,r.to),o=await r.request(n,i);return this.emit("Request.end",this,i),o}}}).call(this,n(5))},function(t,e,n){"use strict";e.Action=n(4),e.Application=n(13),e.Channel=n(2),e.Event=n(11),e.Flow=n(8),e.Milestone=n(10),e.Node=n(6),e.Request=n(9),e.Spider=n(7),e.StandardChannel=n(50),e.StandardNode=n(51),e.ErrorChannel=n(52)},function(t,e){var n=function(t,e){return{parse:function(e,r){var s=JSON.parse(e,o).map(i),a=s[0],u=r||n,c="object"==typeof a&&a?function e(n,r,i,o){return Object.keys(i).reduce(function(i,s){var a=i[s];if(a instanceof t){var u=n[a];"object"!=typeof u||r.has(u)?i[s]=o.call(i,s,u):(r.add(u),i[s]=o.call(i,s,e(n,r,u,o)))}else i[s]=o.call(i,s,a);return i},i)}(s,new Set,a,u):a;return u.call({"":c},"",c)},stringify:function(t,i,o){for(var s,a=new Map,u=[],c=[],f=i&&typeof i==typeof u?function(t,e){if(""===t||-1<i.indexOf(t))return e}:i||n,l=+r(a,u,f.call({"":t},"",t)),h=function(t,n){if(s)return s=!s,n;var i=f.call(this,t,n);switch(typeof i){case"object":if(null===i)return i;case e:return a.get(i)||r(a,u,i)}return i};l<u.length;l++)s=!0,c[l]=JSON.stringify(u[l],h,o);return"["+c.join(",")+"]"}};function n(t,e){return e}function r(e,n,r){var i=t(n.push(r)-1);return e.set(r,i),i}function i(e){return e instanceof t?t(e):e}function o(n,r){return typeof r===e?new t(r):r}}(String,"string");t.exports=n},function(t,e,n){var r=n(3);t.exports=r,n(27)()},function(t,e){var n={};t.exports=n;var r={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(r).forEach(function(t){var e=r[t],i=n[t]=[];i.open="["+e[0]+"m",i.close="["+e[1]+"m"})},function(t,e,n){"use strict";(function(e){var r=n(19),i=n(20),o=e.env,s=void 0;function a(t){return function(t){return 0!==t&&{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}(function(t){if(!1===s)return 0;if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2;if(t&&!t.isTTY&&!0!==s)return 0;var n=s?1:0;if("win32"===e.platform){var a=r.release().split(".");return Number(e.versions.node.split(".")[0])>=8&&Number(a[0])>=10&&Number(a[2])>=10586?Number(a[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(function(t){return t in o})||"codeship"===o.CI_NAME?1:n;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in o){var u=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return u>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)?1:"COLORTERM"in o?1:(o.TERM,n)}(t))}i("no-color")||i("no-colors")||i("color=false")?s=!1:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(s=!0),"FORCE_COLOR"in o&&(s=0===o.FORCE_COLOR.length||0!==parseInt(o.FORCE_COLOR,10)),t.exports={supportsColor:a,stdout:a(e.stdout),stderr:a(e.stderr)}}).call(this,n(5))},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},function(t,e,n){"use strict";(function(e){t.exports=function(t,n){var r=(n=n||e.argv).indexOf("--"),i=/^-{1,2}/.test(t)?"":"--",o=n.indexOf(i+t);return-1!==o&&(-1===r||o<r)}}).call(this,n(5))},function(t,e){t.exports=function(t,e){var n="";t=(t=t||"Run the trap, drop the bass").split("");var r={a:["@","Ą","Ⱥ","Ʌ","Δ","Λ","Д"],b:["ß","Ɓ","Ƀ","ɮ","β","฿"],c:["©","Ȼ","Ͼ"],d:["Ð","Ɗ","Ԁ","ԁ","Ԃ","ԃ"],e:["Ë","ĕ","Ǝ","ɘ","Σ","ξ","Ҽ","੬"],f:["Ӻ"],g:["ɢ"],h:["Ħ","ƕ","Ң","Һ","Ӈ","Ԋ"],i:["༏"],j:["Ĵ"],k:["ĸ","Ҡ","Ӄ","Ԟ"],l:["Ĺ"],m:["ʍ","Ӎ","ӎ","Ԡ","ԡ","൩"],n:["Ñ","ŋ","Ɲ","Ͷ","Π","Ҋ"],o:["Ø","õ","ø","Ǿ","ʘ","Ѻ","ם","۝","๏"],p:["Ƿ","Ҏ"],q:["্"],r:["®","Ʀ","Ȑ","Ɍ","ʀ","Я"],s:["§","Ϟ","ϟ","Ϩ"],t:["Ł","Ŧ","ͳ"],u:["Ʊ","Ս"],v:["ט"],w:["Ш","Ѡ","Ѽ","൰"],x:["Ҳ","Ӿ","Ӽ","ӽ"],y:["¥","Ұ","Ӌ"],z:["Ƶ","ɀ"]};return t.forEach(function(t){t=t.toLowerCase();var e=r[t]||[" "],i=Math.floor(Math.random()*e.length);n+=void 0!==r[t]?r[t][i]:t}),n}},function(t,e){t.exports=function(t,e){t=t||"   he is here   ";var n={up:["̍","̎","̄","̅","̿","̑","̆","̐","͒","͗","͑","̇","̈","̊","͂","̓","̈","͊","͋","͌","̃","̂","̌","͐","̀","́","̋","̏","̒","̓","̔","̽","̉","ͣ","ͤ","ͥ","ͦ","ͧ","ͨ","ͩ","ͪ","ͫ","ͬ","ͭ","ͮ","ͯ","̾","͛","͆","̚"],down:["̖","̗","̘","̙","̜","̝","̞","̟","̠","̤","̥","̦","̩","̪","̫","̬","̭","̮","̯","̰","̱","̲","̳","̹","̺","̻","̼","ͅ","͇","͈","͉","͍","͎","͓","͔","͕","͖","͙","͚","̣"],mid:["̕","̛","̀","́","͘","̡","̢","̧","̨","̴","̵","̶","͜","͝","͞","͟","͠","͢","̸","̷","͡"," ҉"]},r=[].concat(n.up,n.down,n.mid);function i(t){return Math.floor(Math.random()*t)}function o(t){var e=!1;return r.filter(function(n){e=n===t}),e}return function(t,e){var r,s,a="";for(s in(e=e||{}).up=void 0===e.up||e.up,e.mid=void 0===e.mid||e.mid,e.down=void 0===e.down||e.down,e.size=void 0!==e.size?e.size:"maxi",t=t.split(""))if(!o(s)){switch(a+=t[s],r={up:0,down:0,mid:0},e.size){case"mini":r.up=i(8),r.mid=i(2),r.down=i(8);break;case"maxi":r.up=i(16)+3,r.mid=i(4)+1,r.down=i(64)+3;break;default:r.up=i(8)+1,r.mid=i(6)/2,r.down=i(8)+1}var u=["up","mid","down"];for(var c in u)for(var f=u[c],l=0;l<=r[f];l++)e[f]&&(a+=n[f][i(n[f].length)])}return a}(t,e)}},function(t,e,n){var r=n(3);t.exports=function(t,e,n){if(" "===t)return t;switch(e%3){case 0:return r.red(t);case 1:return r.white(t);case 2:return r.blue(t)}}},function(t,e,n){var r=n(3);t.exports=function(t,e,n){return e%2==0?t:r.inverse(t)}},function(t,e,n){var r,i=n(3);t.exports=(r=["red","yellow","green","blue","magenta"],function(t,e,n){return" "===t?t:i[r[e++%r.length]](t)})},function(t,e,n){var r,i=n(3);t.exports=(r=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta"],function(t,e,n){return" "===t?t:i[r[Math.round(Math.random()*(r.length-1))]](t)})},function(t,e,n){var r=n(3);t.exports=function(){var t=function(t,e){String.prototype.__defineGetter__(t,e)};function e(e){var n=["__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__","charAt","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf","charCodeAt","indexOf","lastIndexof","length","localeCompare","match","repeat","replace","search","slice","split","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"];Object.keys(e).forEach(function(i){-1!==n.indexOf(i)?console.log("warn: ".red+("String.prototype"+i).magenta+" is probably something you don't want to override. Ignoring style name"):"string"==typeof e[i]?(r[i]=r[e[i]],t(i,function(){return r[e[i]](this)})):t(i,function(){for(var t=this,n=0;n<e[i].length;n++)t=r[e[i][n]](t);return t})})}t("strip",function(){return r.strip(this)}),t("stripColors",function(){return r.strip(this)}),t("trap",function(){return r.trap(this)}),t("zalgo",function(){return r.zalgo(this)}),t("zebra",function(){return r.zebra(this)}),t("rainbow",function(){return r.rainbow(this)}),t("random",function(){return r.random(this)}),t("america",function(){return r.america(this)}),Object.keys(r.styles).forEach(function(e){t(e,function(){return r.stylize(this,e)})}),r.setTheme=function(t){if("string"==typeof t)try{return r.themes[t]=n(28)(t),e(r.themes[t]),r.themes[t]}catch(t){return console.log(t),t}else e(t)}}},function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=28},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<o;u=r[++n])g(u)||!b(u)?s+=" "+u:s+=" "+a(u);return s},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,s={};function a(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),f(r,t,r.depth)}function u(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function c(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&_(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=f(t,i,r)),i}var o=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(y(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,n);if(o)return o;var s=Object.keys(n),a=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),O(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(n);if(0===s.length){if(_(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(O(n))return l(n)}var c,b="",A=!1,S=["{","}"];(p(n)&&(A=!0,S=["[","]"]),_(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return v(n)&&(b=" "+RegExp.prototype.toString.call(n)),E(n)&&(b=" "+Date.prototype.toUTCString.call(n)),O(n)&&(b=" "+l(n)),0!==s.length||A&&0!=n.length?r<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=A?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)R(e,String(s))?o.push(h(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}(t,n,r,a,s):s.map(function(e){return h(t,n,r,a,e,A)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,b,S)):S[0]+b+S[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),R(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=g(n)?f(t,u.value,null):f(t,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function w(t){return void 0===t}function v(t){return b(t)&&"[object RegExp]"===A(t)}function b(t){return"object"==typeof t&&null!==t}function E(t){return b(t)&&"[object Date]"===A(t)}function O(t){return b(t)&&("[object Error]"===A(t)||t instanceof Error)}function _(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(w(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=v,e.isObject=b,e.isDate=E,e.isError=O,e.isFunction=_,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(30);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":"),[t.getDate(),P[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n(31),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var x="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function T(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(x&&t[x]){var e;if("function"!=typeof(e=t[x]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise(function(t,r){e=t,n=r}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(t,r){t?n(t):e(r)});try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),x&&Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=x,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};e.apply(this,n).then(function(e){t.nextTick(s,null,e)},function(e){t.nextTick(T,e,s)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(5))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";t.exports=class extends Error{constructor(t){super(t),this.name="CyclicalError"}}},function(t,e,n){"use strict";e.decode=e.parse=n(34),e.encode=e.stringify=n(35)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var f=0;f<c;++f){var l,h,p,d,g=t[f].replace(a,"%20"),y=g.indexOf(n);y>=0?(l=g.substr(0,y),h=g.substr(y+1)):(l=g,h=""),p=decodeURIComponent(l),d=decodeURIComponent(h),r(s,p)?i(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],function(t){return a+encodeURIComponent(r(t))}).join(e):a+encodeURIComponent(r(t[s]))}).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){"use strict";const r=n(37);t.exports=(()=>r())},function(t,e,n){"use strict";(function(e){const r=n(42),i=n(45),o=Math.pow(2,31)-1;function s(t,n){var r=e.from(i.parse(t)).toString("base64");return n?r.replace(/\+/g,"_").replace(/\//g,"-").replace(/==$/,"-"):r.replace(/==$/,"/")}function a(t,n){!!(n=n||{}).urlSafe&&(t=t.replace(/-/g,"/").replace(/_/g,"+"));const r=t.match(/(.*)+\/(\d+)+$/);return r?{uuid:i.unparse(e.from(r[1]+"==","base64")),count:parseInt(r[2])}:null}t.exports=function(t){var e=!1,n=!1;"boolean"==typeof t?e=t:(n=!!(t=t||{}).urlSafe,e=!!t.fixedLength);var i=0;c.uuid=r();var u=s(c.uuid,n);function c(){var t=e?u+function(t){return t<10?`000000000${t}`:t<100?`00000000${t}`:t<1e3?`0000000${t}`:t<1e4?`000000${t}`:t<1e5?`00000${t}`:t<1e6?`0000${t}`:t<1e7?`000${t}`:t<1e8?`00${t}`:t<1e9?`0${t}`:void 0}(i++):u+i++;return i===o&&(c.uuid=r(),u=s(c.uuid,n),i=0),t}return c.decode=a,c},t.exports.decode=a}).call(this,n(38).Buffer)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(39),i=n(40),o=n(41);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(f(e),t=a(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return k(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(t).length;default:if(r)return k(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var l=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){l=!1;break}if(l)return o}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function v(t,e,n,r){return $(k(e,t.length-n),t,n,r)}function b(t,e,n,r){return $(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return b(t,e,n,r)}function O(t,e,n,r){return $(J(e),t,n,r)}function _(t,e,n,r){return $(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],f=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=n)switch(l){case 1:c<128&&(f=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(f=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=P));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return R(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),f=t.slice(e,n),l=0;l<a;++l)if(c[l]!==f[l]){o=c[l],s=f[l];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function R(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function x(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=L(t[o]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function j(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function C(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function U(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,o){return o||U(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,o){return o||U(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||j(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||j(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||j(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||j(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||j(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||j(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||j(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||j(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||j(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||j(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||j(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||j(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||j(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||j(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:k(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var q=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function k(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function J(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(q,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(12))},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),u=0,f=s>0?r-4:r,l=0;l<f;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],a[u++]=e>>16&255,a[u++]=e>>8&255,a[u++]=255&e;2===s&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,a[u++]=255&e);1===s&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,a[u++]=e>>8&255,a[u++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(f(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=t[e+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){var r=n(43),i=n(44);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||i(s)}},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},function(t,e,n){"use strict";for(var r=[],i={},o=0;o<256;o++)r[o]=(o+256).toString(16).substr(1),i[r[o]]=o;t.exports={parse:function(t,e,n){const r=e&&n||0;let o=0;for(e=e||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){o<16&&(e[r+o++]=i[t])});o<16;)e[r+o++]=0;return e},unparse:function(t,e){let n=e||0;const i=r;return i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]}}},function(t,e,n){"use strict";(function(e){var r=s(n(11)),i=s(n(7)),o=s(n(49));function s(t){return t&&t.__esModule?t:{default:t}}const a=n(1),u=n(0),c=new WeakMap;t.exports=class extends a{constructor(t,e){super(),this.application=t,void 0!==e&&this.fromJSON({pendingEvents:e||[]})}push(t,n=!0){this.log.debug("Pushing event to queue..."),c.get(this.application).push(t),n&&(this.log.debug("Scheduling event queue processing..."),e(()=>this.process()))}async process(){this.log.debug("Processing event queue...");const t=c.get(this.application);if(!t)throw new Error("Event Queue does not have a bound application.");if(t.length>0){this.log.debug(`Event queue has ${t.length} events remaining...`);const e=t.shift();if(e&&e instanceof r.default){if(this.log.debug(`Processing event ${e.type} -> with target: ${e.from.name}`),e.from&&e.from.process){this.log.debug(`Preparing Action Context from ${e.from.name}`);const t=new o.default(this.application,e.flow,e.from,e.request);this.log.debug("Processing event step...");try{await e.from.process(e,t),e.request.addStep(this.application,e.flow,e.from)}catch(t){this.log.debug("Caught error...");let n,r=e.from.retry||0;if(void 0===e.from.accepts){const t=e.request.steps[e.request.steps.length-1];if(t&&this.application.id===t.appId){const e=(new i.default).search(this.application,t.flowId);e&&(n=(new i.default).search(e,t.stepId))&&n.retry&&(r=n.retry)}}e.retries<r-1?(this.log.debug("Retrying..."),this.application.dispatch(e.type,e.request,e.flow,n||e.from,e.retries+1)):(this.log.debug("Dispatching error...",t.name),this.application.dispatch(t.name,e.request,e.flow,e.from,e.retries,t))}return e.request}throw new Error("Event.from does not have a process() method.")}throw new Error("Event in Event Queue is not an Event class.")}}toJSON(){return{pendingEvents:c.get(this.application).entries()}}fromJSON(t){let e;if("string"==typeof t)e=this.loadFlattened(t);else{if(!(t instanceof Object)||t instanceof Array)throw new Error(`Expected Event JSON to be a string or an object, but got a ${typeof t} instead`);e=t}this.log=new u(this.application.id,"EventQueue",this.application.name,this.application.config.logLevel,this.application.outputPipe,this.application.errorPipe),c.set(this.application,e.pendingEvents)}}}).call(this,n(47).setImmediate)},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(48),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(12))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,s,a,u=1,c={},f=!1,l=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){d(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(i=l.documentElement,r=function(t){var e=l.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&d(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},h.clearImmediate=p}function p(t){delete c[t]}function d(t){if(f)setTimeout(d,0,t);else{var e=c[t];if(e){f=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{p(t),f=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(12),n(5))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;const r=new WeakMap,i=n(0);e.default=class{constructor(t,e,n,o){r.set(this,{application:t,flow:e,location:n,request:o}),this.log=new i(o.id,"ActionContext",n.name,t.config.logLevel,t.outputPipe,t.errorPipe)}dispatch(t){const{application:e,location:n,request:i,flow:o}=r.get(this);e.dispatch(t,i,o,n)}set(t,e){const{application:n,flow:i,location:o,request:s}=r.get(this);s.change(n,i,o,t,e)}get(t){const{request:e}=r.get(this);return e.getState()[t]}schedule(t,e){const{request:n}=r.get(this);n.addAction(t,e)}async waitFor(t,e){const{application:n,request:i}=r.get(this);this.log.debug("Registering waitFor...");for(const n in i.steps)if(i.steps[n].stepId===t)return this.log.debug("Resolving waitFor..."),e(i);return new Promise((r,o)=>{const s=n.on("Node",async(a,u,c)=>{if(this.log.debug(`Waiting for ${a.name}...`),void 0!==c)return o(u);if(u===i&&a.id===t){let t;this.log.debug(`WaitFor ${a.name} complete.`),n.off(s),e&&(t=await e(u)),r(t)}})})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(2))&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t,e,n,r,i=[],o,s=[]){const a=t.requireAction("gotoNode",function(){this.dispatch("StandardNode")});super(t,e,n,r,["StandardChannel"].concat(i),o,s.concat([a]))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(6))&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t,e,n,r,i,o=[]){const s=t.requireAction("gotoChannel",function(){this.dispatch("StandardChannel")});super(t,e,n,r,i,o.concat([s]))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(2))&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t,e,n,r,i=[],o,s=[]){const a=t.requireAction("gotoNode",function(){this.dispatch("StandardNode")});super(t,e,n,r,["Error"].concat(i),o,s.concat([a]))}}}]);